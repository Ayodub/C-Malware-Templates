#include <Windows.h>
#include <stdio.h>

/* The .text section is special in that it stores variables with executable
memory permissions, allowing it to be executed directly without the need for
editing memory permissions*/

// This is useful for small payloads that are roughly less than 10 bytes

/* To save a payload to the.text section, we must explicitly instruct the
* compiler to save it there with the below initialisation using pragma and __declspec(allocate(.text)): */

/* This pragma is a compiler directive that specifies the name of the section
where the following code or data should be placed.In this case, it is 
specifying that the code or data that follows should be placed in the section
named ".text".The ".text" section typically holds executable code. */

#pragma section(".text")

/* The below Microsoft-specific keyword is used to allocate the following variable
in the specified section. In this case, it's used to allocate Text_RawData in
the ".text" section */

__declspec(allocate(".text")) const unsigned char Text_RawData[] = {

	//place payload in here. msfvenom example:
	// msfvenom -p windows/x64/exec CMD=calc.exe -f c
	// output, which we will save in this variable, will look like:
	// 0xFC, 0x48, 0x83, 0xE4, 0xF0, etc

	0xFC, 0x48, 0x83, 0xE4, 0xF0
	//The actual payload will have many more hex values
};

int main() {

	// Check the base address of the Text_RawData variable:
	printf("[i] Text_RawData var : 0x%p \n", Text_RawData);
	printf("[#] Press <Enter> To Quit ...");
	getchar();
	return 0;

}